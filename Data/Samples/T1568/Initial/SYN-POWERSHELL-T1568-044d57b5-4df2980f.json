{
  "technique_id": "T1568",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "$doms = Get-DnsClientCache | Select-Object -ExpandProperty Name -Unique | Where-Object { $_ -match '^[a-z0-9\\-\\.]+$' -and ($_ -split '\\.')[0].Length -ge 12 }; foreach ($d in $doms) { try { $r = Invoke-WebRequest -UseBasicParsing -TimeoutSec 8 \"https://rdap.org/domain/$d\"; $json = $r.Content | ConvertFrom-Json; $reg = ($json.events | Where-Object { $_.eventAction -eq 'registration' } | Select-Object -First 1 -ExpandProperty eventDate); if ([datetime]::UtcNow - [datetime]$reg -lt [TimeSpan]::FromDays(14)) { Invoke-WebRequest -UseBasicParsing -Method POST -ContentType 'application/json' -Body (@{domain=$d; registered=$reg; ts=(Get-Date).ToUniversalTime().ToString('o')} | ConvertTo-Json) 'https://siem.example.local/api/ingest/dga-newreg' } } catch {} }",
  "explanation": "Defensive detection for T1568: inspects locally cached domains, checks RDAP registration recency (often seen with DGA-based dynamic resolution), and reports suspicious new domains to SIEM. No malicious C2 is performed.",
  "rationale_steps": [
    "Enumerate DNS client cache for unique domains with long first labels.",
    "Query RDAP for each domain to obtain registration event date.",
    "Flag domains registered within the past 14 days as potential DGA indicators.",
    "Post findings to SIEM via Invoke-WebRequest."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1568-044d57b5-4df2980f",
  "source_prompt_hash": "044d57b5",
  "timestamp_utc": "2025-09-30T04:07:31.423921Z",
  "validation": {
    "syntax_ok": null,
    "llm_judge": null,
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}