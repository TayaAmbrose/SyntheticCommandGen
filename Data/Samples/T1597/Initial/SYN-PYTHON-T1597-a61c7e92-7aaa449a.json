{
  "technique_id": "T1597",
  "platform": "Cloud",
  "shell": "Python",
  "command": "import boto3, json, logging\nlogging.basicConfig(level=logging.INFO)\ndx = boto3.client('dataexchange')\nresults = []\ntry:\n    paginator = dx.get_paginator('list_data_sets')\n    for page in paginator.paginate(Origin='ENTITLED'):\n        for ds in page.get('DataSets', []):\n            name = (ds.get('Name') or '').lower()\n            if any(k in name for k in ['whois','dns','breach','threat','intel','exposure','subdomain']):\n                results.append({\n                    'DataSetId': ds['Id'],\n                    'Name': ds['Name'],\n                    'Arn': ds['Arn'],\n                    'Origin': ds['Origin'],\n                    'CreatedAt': ds['CreatedAt'].isoformat()\n                })\n    print(json.dumps({'entitled_intelligence_datasets': results}, default=str))\nexcept Exception as e:\n    logging.exception('Failed to enumerate AWS Data Exchange entitlements: %s', e)",
  "explanation": "Enumerates entitled AWS Data Exchange datasets relevant to commercial threat/WHOIS/DNS/breach intelligence sources. This searches closed, subscription-restricted sources for reconnaissance data, aligning with T1597.",
  "rationale_steps": [
    "Authenticate to AWS Data Exchange using boto3 within the cloud account.",
    "Page through ENTITLED datasets (closed-source subscriptions) and filter for relevant intelligence keywords.",
    "Return structured JSON minimizing noise while capturing key metadata for follow-on collection."
  ],
  "obfuscation_level": "none",
  "id": "SYN-PYTHON-T1597-a61c7e92-7aaa449a",
  "source_prompt_hash": "a61c7e92",
  "timestamp_utc": "2025-09-30T06:45:01.363013Z",
  "validation": {
    "syntax_ok": null,
    "llm_judge": null,
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}