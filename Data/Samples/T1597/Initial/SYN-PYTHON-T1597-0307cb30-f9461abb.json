{
  "technique_id": "T1597",
  "platform": "Linux",
  "shell": "Python",
  "command": "python3 -c 'import os,sys,json,http.client,base64; dom=os.environ.get(\"TARGET_DOMAIN\",\"example.com\"); auth=base64.b64encode((os.environ[\"RISKIQ_EMAIL\"]+\":\"+os.environ[\"RISKIQ_API_KEY\"]).encode()).decode(); c=http.client.HTTPSConnection(\"api.riskiq.net\",timeout=15); h={\"Authorization\":\"Basic \"+auth,\"Accept\":\"application/json\"}; c.request(\"GET\",\"/pt/v2/whois/search?query=\"+dom,headers=h); r=c.getresponse(); b=r.read();\ntry:\n j=json.loads(b.decode());\nexcept Exception:\n j={\"raw\":b.decode(\"utf-8\",\"ignore\")};\nif r.status==200:\n print(json.dumps(j))\nelse:\n sys.stderr.write(f\"HTTP {r.status} {r.reason}: \"+(b[:200].decode(\"utf-8\",\"ignore\"))+\"\\n\"); sys.exit(1)'\n",
  "explanation": "Queries RiskIQ PassiveTotal (paid service) for historical WHOIS data related to the target domain using Basic authentication, returning structured JSON.",
  "rationale_steps": [
    "Read credentials and target domain from environment variables to avoid hardcoding secrets.",
    "Establish HTTPS connection to api.riskiq.net with Basic Auth and request WHOIS search.",
    "Parse JSON response and print structured output; handle and log HTTP/parse errors."
  ],
  "obfuscation_level": "none",
  "id": "SYN-PYTHON-T1597-0307cb30-f9461abb",
  "source_prompt_hash": "0307cb30",
  "timestamp_utc": "2025-09-30T06:31:45.744266Z",
  "validation": {
    "syntax_ok": null,
    "llm_judge": null,
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}