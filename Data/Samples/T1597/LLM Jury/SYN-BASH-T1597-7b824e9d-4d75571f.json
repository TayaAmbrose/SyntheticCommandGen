{
  "technique_id": "T1597",
  "platform": "Linux",
  "shell": "Bash",
  "command": "bash -lc 'set -euo pipefail; ts=$(date -u +%FT%TZ); d=$(date -u +%F); dest=/opt/ti/closed/enrichment/$d; mkdir -p \"$dest\"; if scp -q -i /etc/ssh/keys/cpe_enrich_ed25519 -o StrictHostKeyChecking=yes -o UserKnownHostsFile=/etc/ssh/known_hosts_cpe_enrich -o IdentitiesOnly=yes feeds@sftp.cpe-enrichment.com:/feeds/enrichment/acme_corp/products.json{,.sha256} \"$dest\"/ && (cd \"$dest\" && sha256sum -c products.json.sha256); then printf \"{\\\"timestamp\\\":\\\"%s\\\",\\\"technique\\\":\\\"T1597\\\",\\\"source\\\":\\\"cpe-enrichment\\\",\\\"artifact\\\":\\\"%s/products.json\\\",\\\"status\\\":\\\"verified\\\"}\\n\" \"$ts\" \"$dest\" | tee -a /var/log/ti_fetch.json; else printf \"{\\\"timestamp\\\":\\\"%s\\\",\\\"technique\\\":\\\"T1597\\\",\\\"source\\\":\\\"cpe-enrichment\\\",\\\"status\\\":\\\"error\\\"}\\n\" \"$ts\" >&2; fi'",
  "explanation": "Downloads a closed-source product/CPE enrichment dataset (JSON) used to enhance internal asset intelligence on the target, consistent with T1597.",
  "rationale_steps": [
    "Securely authenticate and enforce host key checking.",
    "Fetch enrichment JSON and its checksum from the paid SFTP feed.",
    "Validate integrity and place into a dated folder.",
    "Emit JSON-formatted status for downstream processing."
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1597-7b824e9d-4d75571f",
  "source_prompt_hash": "7b824e9d",
  "timestamp_utc": "2025-09-30T06:47:02.517764Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, proper command separators, valid flags, appropriate error handling with set -euo pipefail, and clean variable usage throughout.",
        "semantic_score": 5,
        "semantic_justification": "The command fully aligns with T1597 (Search Closed Sources) by securely retrieving and verifying a non-public intelligence feed from a closed source using proper authentication, integrity verification, and logging mechanisms.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T13:40:38.105251Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, valid flags, correct command separators, and proper use of bash features like brace expansion and command substitution.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1597 by downloading specific 'products.json' data from a dedicated 'cpe-enrichment' SFTP service using SSH, a highly plausible method for acquiring intelligence from a closed, paid, or private source.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-02T13:40:56.298613Z"
      },
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "The Bash one-liner uses valid set/if syntax, balanced quoting and grouping, correct scp options and brace expansion, and properly chains checksum verification and logging.",
        "semantic_score": 5,
        "semantic_justification": "It acquires a closed-source dataset via authenticated SFTP, verifies integrity, stores it in an internal path, and logs the action as T1597, aligning with \u201cSearch Closed Sources.\u201d",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T13:41:12.110926Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 5.0,
    "llm_average_score": 5.0,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}