{
  "technique_id": "T1597",
  "platform": "Linux",
  "shell": "Bash",
  "command": "bash -lc 'set -euo pipefail; ts=$(date -u +%FT%TZ); d=$(date -u +%F); dest=/opt/ti/closed/registries/$d; mkdir -p \"$dest\"; if scp -q -P 22 -i /etc/ssh/keys/corpdata_ed25519 -o StrictHostKeyChecking=yes -o UserKnownHostsFile=/etc/ssh/known_hosts_corpdata -o IdentitiesOnly=yes feedreader@sftp.corpdata-secure.com:/exports/registries/acme_corp/latest.json{,.sha256} \"$dest\"/ && (cd \"$dest\" && sha256sum -c latest.json.sha256); then printf \"{\\\"timestamp\\\":\\\"%s\\\",\\\"technique\\\":\\\"T1597\\\",\\\"source\\\":\\\"corpdata-secure\\\",\\\"artifact\\\":\\\"%s/latest.json\\\",\\\"status\\\":\\\"verified\\\"}\\n\" \"$ts\" \"$dest\" | tee -a /var/log/ti_fetch.json; else printf \"{\\\"timestamp\\\":\\\"%s\\\",\\\"technique\\\":\\\"T1597\\\",\\\"source\\\":\\\"corpdata-secure\\\",\\\"status\\\":\\\"error\\\"}\\n\" \"$ts\" >&2; fi'",
  "explanation": "Securely retrieves a subscription-only corporate registry dataset (JSON) via the vendor's SFTP portal, verifies integrity, and logs a JSON status. This aligns with T1597 by accessing closed-source commercial records.",
  "rationale_steps": [
    "Authenticate to sftp.corpdata-secure.com using an approved SSH key with strict host key validation.",
    "Download the latest corporate registry JSON and its checksum.",
    "Validate file integrity with sha256sum.",
    "Store artifacts in a controlled directory and emit a JSON status log."
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1597-7b824e9d-812331a0",
  "source_prompt_hash": "7b824e9d",
  "timestamp_utc": "2025-09-30T06:47:02.517764Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, proper command separators, valid flags, appropriate error handling with set -euo pipefail, and correct use of conditional logic.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1597 (Search Closed Sources) by securely retrieving subscription-based corporate registry data via SFTP, implementing proper authentication with SSH keys, verifying file integrity with SHA256, and maintaining detailed logging of the operation.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T13:41:43.166590Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, correct command separators, valid flags, and proper variable expansions.",
        "semantic_score": 5,
        "semantic_justification": "The command flawlessly executes the claimed intent of retrieving and verifying a closed-source commercial data feed via SFTP, directly aligning with T1597's description of acquiring non-public information.",
        "combined_score": 5.0,
        "confidence": 1.0,
        "timestamp": "2025-10-02T13:41:56.520255Z"
      },
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Well-formed with balanced single/double quotes and braces, valid scp/printf options, proper use of set -euo pipefail, and a correct if/then/else structure with pipelines.",
        "semantic_score": 4,
        "semantic_justification": "Accurately performs T1597 by pulling closed-source data via authenticated SSH, verifying integrity with sha256sum, and logging JSON status, though writing to /opt and /var/log may require privileges not accounted for.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-02T13:42:55.257902Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.667,
    "llm_average_score": 4.833,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}