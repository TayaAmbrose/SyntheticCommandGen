{
  "technique_id": "T1205",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "Invoke-Command -ScriptBlock { $target='10.0.0.25'; $seqB64='NzAwMCw4MDAwLDkwMDA='; $ports = [Text.Encoding]::ASCII.GetString([Convert]::FromBase64String($seqB64)).Split(',') | ForEach-Object { [int]$_ }; foreach($p in $ports){ $null = Test-NetConnection -ComputerName $target -Port $p -InformationLevel Quiet; Start-Sleep -Milliseconds 300 } }",
  "explanation": "Sends a base64-encoded port-knock sequence (7000, 8000, 9000) using TCP SYN probes to a target. This can unlock a hidden service on the remote if it runs a knock responder. Detection: alert on repeated failed connection attempts to uncommon high ports in rapid succession from the same source; match known knocking sequences. No elevation required; UAC not triggered.",
  "rationale_steps": [
    "Decode knock sequence from base64 and iterate ports in order.",
    "Send TCP SYN via Test-NetConnection to emulate a knock sequence.",
    "Rely on remote knock daemon to enable functionality upon correct sequence."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1205-1108f921-23e8f28f",
  "source_prompt_hash": "1108f921",
  "timestamp_utc": "2025-09-30T05:58:00.779201Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "PowerShell command is well-formed with balanced braces/quotes, valid parameters, and proper separators.",
        "semantic_score": 3,
        "semantic_justification": "Implements a plausible port-knock via Test-NetConnection aligning with T1205, but the use of [Text.Encoding] (instead of [System.Text.Encoding]) would likely cause a runtime type resolution error, preventing execution as written.",
        "combined_score": 4.0,
        "confidence": 0.8,
        "timestamp": "2025-10-01T13:49:09.529404Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced quotes, braces, and parentheses, proper PowerShell syntax for variable assignment, string conversion, array manipulation, and command execution.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly implements the Traffic Signaling technique by sending a sequence of TCP connection attempts to specific ports (7000, 8000, 9000) that could serve as a covert knock sequence to trigger a hidden service on the target system.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-01T13:49:12.828241Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with balanced syntax, proper cmdlet usage, valid parameters, and correct PowerShell constructs.",
        "semantic_score": 5,
        "semantic_justification": "The command precisely executes a port-knocking sequence via TCP SYN probes, which is a classic example of traffic signaling (T1205) to trigger an action on a remote system, fully aligning with the technique's description.",
        "combined_score": 5.0,
        "confidence": 1.0,
        "timestamp": "2025-10-01T13:49:21.050931Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.333,
    "llm_average_score": 4.667,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}