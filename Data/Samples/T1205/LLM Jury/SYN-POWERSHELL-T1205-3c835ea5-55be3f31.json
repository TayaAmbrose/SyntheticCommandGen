{
  "technique_id": "T1205",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "$mac='00-11-22-33-44-55';$m=$mac -split '[:-]';$mb=$m|ForEach-Object{[Convert]::ToByte($_,16)};$wol=New-Object System.Collections.Generic.List[byte];1..6|ForEach-Object{$wol.Add(0xFF)};1..16|ForEach-Object{$mb|ForEach-Object{$wol.Add($_)}};& netsh advfirewall firewall add rule name='WOL-UDP9' dir=out action=allow protocol=UDP remoteport=9 remoteip=255.255.255.255 >$null;$u=New-Object System.Net.Sockets.UdpClient;$u.EnableBroadcast=$true;$b=$wol.ToArray();$u.Send($b,$b.Length,'255.255.255.255',9) >$null",
  "explanation": "Generates a Wake-on-LAN magic packet (6 bytes of FF followed by 16 repetitions of the target MAC) and broadcasts it to UDP/9, potentially waking a remote pivot host. A netsh firewall rule is added to ensure the broadcast is allowed. Admin rights may be required in locked-down environments.",
  "rationale_steps": [
    "Construct a correct WoL magic packet payload for the target MAC.",
    "Temporarily ensure outbound UDP/9 broadcast is permitted via netsh and send the packet.",
    "Detection: watch for UDP/9 broadcasts with 102-byte WoL signature, and new outbound firewall rules allowing broadcast traffic."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1205-3c835ea5-55be3f31",
  "source_prompt_hash": "3c835ea5",
  "timestamp_utc": "2025-09-30T05:43:16.300607Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Well-formed PowerShell with balanced quotes and separators; valid list/byte handling, netsh invocation, and UdpClient usage with acceptable redirections.",
        "semantic_score": 4,
        "semantic_justification": "Accurately crafts and broadcasts a WoL magic packet and attempts to allow outbound UDP/9, aligning with traffic signaling to trigger a remote action, though success depends on WoL support, network scope, and possible admin requirement for the firewall rule.",
        "combined_score": 4.5,
        "confidence": 0.8,
        "timestamp": "2025-10-01T16:47:09.741082Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, with correct PowerShell syntax, balanced elements, valid command separators, and proper use of .NET methods and external commands.",
        "semantic_score": 4,
        "semantic_justification": "The command accurately constructs and attempts to broadcast a Wake-on-LAN magic packet, which aligns with Traffic Signaling (T1205) by using legitimate network traffic to trigger a remote action; however, the `netsh` command to add a firewall rule will fail under the stated 'Privilege: None', creating a minor realism gap for the full command's operational success.",
        "combined_score": 4.5,
        "confidence": 1,
        "timestamp": "2025-10-01T16:47:45.574772Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell command is perfectly well-formed with proper variable declarations, method calls, balanced quotes/braces, appropriate operators, and correct pipeline usage throughout.",
        "semantic_score": 4,
        "semantic_justification": "The command correctly implements a Wake-on-LAN packet with proper formatting (magic packet with FF bytes followed by repeated MAC address) and UDP broadcast to port 9, though it's debatable whether this fully aligns with the Traffic Signaling technique as it's more of a standard protocol than covert signaling.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-02T03:17:31.610134Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.0,
    "llm_average_score": 4.5,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}