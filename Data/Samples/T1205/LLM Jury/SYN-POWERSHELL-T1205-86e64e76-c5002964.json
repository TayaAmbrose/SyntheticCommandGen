{
  "technique_id": "T1205",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "Test-NetConnection -ComputerName 255.255.255.255 -Port 9 -InformationLevel Quiet | Out-Null; $mac='00-25-96-12-34-56'; $bytes=$mac.Split('-') | ForEach-Object {[byte]('0x'+$_)}; $packet = @([byte]0xFF,[byte]0xFF,[byte]0xFF,[byte]0xFF,[byte]0xFF,[byte]0xFF); 1..16 | ForEach-Object { $packet += $bytes }; $udp = New-Object System.Net.Sockets.UdpClient; $udp.EnableBroadcast = $true; $udp.Send($packet, $packet.Length, '255.255.255.255', 9) | Out-Null",
  "explanation": "Generates a Wake-on-LAN magic packet (6x FF followed by 16x target MAC) to wake a device via UDP/9 broadcast. Detection: monitor for broadcast UDP/9 packets with WOL signatures; restrict WOL to authorized subnets and log anomalies.",
  "rationale_steps": [
    "Optionally verify broadcast path reachability using Test-NetConnection.",
    "Construct a WOL-compliant magic packet (6x 0xFF + 16x MAC).",
    "Broadcast the packet on UDP port 9 to wake the target device.",
    "Defenders: inspect for WOL packet patterns on UDP/7 or UDP/9 and validate sender authorization."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1205-86e64e76-c5002964",
  "source_prompt_hash": "86e64e76",
  "timestamp_utc": "2025-09-30T05:55:46.844640Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell one-liner is well-formed with balanced quotes/braces, valid cmdlets/parameters, and proper separators/pipelines.",
        "semantic_score": 2,
        "semantic_justification": "It intends to send a Wake-on-LAN magic packet via UDP/9 broadcast but incorrectly converts hex octets using [byte]('0x'+$_), resulting in an invalid payload (likely only the 6xFF preamble) that will not achieve the stated WOL behavior.",
        "combined_score": 3.5,
        "confidence": 0.8,
        "timestamp": "2025-10-01T13:19:24.318950Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with proper PowerShell syntax, balanced quotes, correct variable assignments, appropriate method calls, and proper pipeline operations.",
        "semantic_score": 4,
        "semantic_justification": "The command correctly implements a Wake-on-LAN packet which could be used for traffic signaling, but it's more aligned with legitimate network administration than a covert C2 channel, though it could potentially be misused as a trigger mechanism.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-01T13:19:27.804326Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, using correct PowerShell syntax for cmdlets, object instantiation, variable assignments, and array manipulations.",
        "semantic_score": 5,
        "semantic_justification": "The command correctly constructs and sends a standard Wake-on-LAN magic packet via UDP broadcast, which operationally aligns with using legitimate-looking network traffic as a signal within the T1205 technique.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-01T13:19:47.673395Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 3.667,
    "llm_average_score": 4.333,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}