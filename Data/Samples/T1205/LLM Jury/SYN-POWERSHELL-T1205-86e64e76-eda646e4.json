{
  "technique_id": "T1205",
  "platform": "Windows",
  "shell": "PowerShell",
  "command": "$gw='192.0.2.255'; Test-NetConnection -ComputerName $gw -Port 7 -InformationLevel Quiet | Out-Null; $mac='AA-BB-CC-DD-EE-FF'; $mb=$mac.Split('-') | ForEach-Object {[byte]('0x'+$_)}; $pkt = @([byte]0xFF,[byte]0xFF,[byte]0xFF,[byte]0xFF,[byte]0xFF,[byte]0xFF); 1..16 | ForEach-Object { $pkt += $mb }; $udp = New-Object System.Net.Sockets.UdpClient; $udp.EnableBroadcast = $true; $udp.Send($pkt, $pkt.Length, $gw, 7) | Out-Null",
  "explanation": "Sends a WOL-formatted magic packet to a directed broadcast address on UDP/7 to trigger device wake. Detection: flag directed broadcasts carrying WOL signatures; monitor for WOL packets outside authorized windows or VLANs.",
  "rationale_steps": [
    "Validate reachability to the directed broadcast on UDP/7 using Test-NetConnection.",
    "Build the correct WOL magic packet structure.",
    "Transmit the packet to the subnet broadcast to wake the device.",
    "Defenders: alert on WOL packets traversing routing boundaries or outside maintenance windows."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1205-86e64e76-eda646e4",
  "source_prompt_hash": "86e64e76",
  "timestamp_utc": "2025-09-30T05:55:46.844640Z",
  "validation": {
    "syntax_ok": null,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "PowerShell syntax is well-formed with balanced quoting, valid pipelines, and correct method/property usage.",
        "semantic_score": 4,
        "semantic_justification": "It correctly builds and sends a WOL magic packet over UDP broadcast aligning with Traffic Signaling, though the TEST-NET address and use of port 7 may reduce real-world effectiveness.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-01T16:44:55.330777Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell command is perfectly well-formed, using valid cmdlets, operators, variable assignments, and object instantiations without any syntax errors or imbalances.",
        "semantic_score": 5,
        "semantic_justification": "The command correctly constructs and sends a standard Wake-on-LAN (WOL) 'magic packet' to a directed broadcast address via UDP, aligning perfectly with the T1205 technique of using legitimate network traffic (WOL) as a signal for adversarial purposes.",
        "combined_score": 5.0,
        "confidence": 1,
        "timestamp": "2025-10-01T16:45:17.011357Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The PowerShell command is perfectly well-formed with proper variable assignments, method calls, balanced quotes, parentheses, and braces, and uses valid PowerShell syntax throughout.",
        "semantic_score": 4,
        "semantic_justification": "The command implements a form of traffic signaling by sending a specially crafted Wake-on-LAN packet to a broadcast address which could be used as a trigger mechanism, though it's using a standard protocol rather than a fully covert channel.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-02T03:17:24.104633Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 4.333,
    "llm_average_score": 4.667,
    "llm_verdict": "likely_match",
    "sandbox_trace_id": null,
    "mitre_match_score": null
  }
}